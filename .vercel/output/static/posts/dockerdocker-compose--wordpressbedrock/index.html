<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="canonical" href="https://priver.dev/posts/dockerdocker-compose--wordpressbedrock/">
    <meta name="generator" content="Astro v1.6.13">

    <!-- General Meta Tags -->
    <title>Docker(Docker-compose) + Wordpress/Bedrock.</title>
    <meta name="title" content="Docker(Docker-compose) + Wordpress/Bedrock.">
    <meta name="description" content="Develop a Wordpress site using Docker and Docker compose">
    <meta name="author" content="Emil Privér">

    <!-- Open Graph / Facebook -->
    <meta property="og:title" content="Docker(Docker-compose) + Wordpress/Bedrock.">
    <meta property="og:description" content="Develop a Wordpress site using Docker and Docker compose">
    <meta property="og:url" content="https://priver.dev/posts/dockerdocker-compose--wordpressbedrock/">
    <meta property="og:image" content="https://priver.dev/astropaper-og.jpg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://priver.dev/posts/dockerdocker-compose--wordpressbedrock/">
    <meta property="twitter:title" content="Docker(Docker-compose) + Wordpress/Bedrock.">
    <meta property="twitter:description" content="Develop a Wordpress site using Docker and Docker compose">
    <meta property="twitter:image" content="https://priver.dev/astropaper-og.jpg">

    <!-- Google Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,400;0,500;0,600;0,700;1,400;1,600&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">

    <script src="/toggle-theme.js"></script>
  <link rel="stylesheet" href="/assets/about.311c2337.css" />
<link rel="stylesheet" href="/assets/_slug_.1fb8df1a.css" />
<link rel="stylesheet" href="/assets/_slug_.01d71da7.css" />
<link rel="stylesheet" href="/assets/about.570f4154.css" />
<link rel="stylesheet" href="/assets/_slug_.1b182ae4.css" />
<link rel="stylesheet" href="/assets/_slug_.778dab85.css" /><script type="module">const e=document.querySelector(".hamburger-menu"),n=document.querySelector("#menu-items")?.classList,t=document.querySelector(".icon-container")?.classList,o=document.querySelector("#first-line")?.classList,a=document.querySelector("#second-line ")?.classList,s=document.querySelector("#third-line")?.classList;e.addEventListener("click",function(r){e?.getAttribute("aria-expanded")==="false"?(e?.setAttribute("aria-expanded","true"),e?.setAttribute("aria-label","Close Menu"),n?.remove("display-none"),t?.remove("flex"),t?.add("relative"),o?.add("rotate-45","absolute","bottom-1/2"),s?.add("display-none"),a?.add("!w-full","-rotate-45","absolute","bottom-1/2")):(e?.setAttribute("aria-expanded","false"),e?.setAttribute("aria-label","Open Menu"),n?.add("display-none"),t?.add("flex"),t?.remove("relative"),o?.remove("rotate-45","absolute","bottom-1/2"),s?.remove("display-none"),a?.remove("!w-full","-rotate-45","absolute","bottom-1/2"))});
</script></head>
  <body>
    <header class="astro-IMPBK3X5">
  <a id="skip-to-content" href="#main-content" class="astro-IMPBK3X5">Skip to content</a>
  <div class="nav-container astro-IMPBK3X5">
    <div class="top-nav-wrap astro-IMPBK3X5">
      <a href="/" class="logo astro-IMPBK3X5">
        Emil Privér
      </a>
      <nav id="nav-menu" class="astro-IMPBK3X5">
        <button class="hamburger-menu focus-outline astro-IMPBK3X5" aria-label="Open Menu" aria-expanded="false" aria-controls="menu-items">
          <div class="icon-container flex astro-IMPBK3X5">
            <div id="first-line" class="astro-IMPBK3X5"></div>
            <div id="second-line" class="astro-IMPBK3X5"></div>
            <div id="third-line" class="astro-IMPBK3X5"></div>
          </div>
        </button>
        <ul id="menu-items" class="display-none sm:flex astro-IMPBK3X5">
          <li class="astro-IMPBK3X5">
            <a href="/posts" class=" astro-IMPBK3X5">
              Posts
            </a>
          </li>
          <li class="astro-IMPBK3X5">
            <a href="/tags" class=" astro-IMPBK3X5">
              Tags
            </a>
          </li>
          <li class="astro-IMPBK3X5">
            <a href="/about" class=" astro-IMPBK3X5">
              About
            </a>
          </li>
          <li class="astro-IMPBK3X5">
            <a type="button" href="/search" tabindex="0" class="group focus-outline p-3 sm:p-1  astro-IMPBK3X5 astro-AENLN72D" aria-label="search" title="Search">
  <svg xmlns="http://www.w3.org/2000/svg" class="scale-125 sm:scale-100 astro-IMPBK3X5"><path d="M19.023 16.977a35.13 35.13 0 0 1-1.367-1.384c-.372-.378-.596-.653-.596-.653l-2.8-1.337A6.962 6.962 0 0 0 16 9c0-3.859-3.14-7-7-7S2 5.141 2 9s3.14 7 7 7c1.763 0 3.37-.66 4.603-1.739l1.337 2.8s.275.224.653.596c.387.363.896.854 1.384 1.367l1.358 1.392.604.646 2.121-2.121-.646-.604c-.379-.372-.885-.866-1.391-1.36zM9 14c-2.757 0-5-2.243-5-5s2.243-5 5-5 5 2.243 5 5-2.243 5-5 5z" class="astro-IMPBK3X5"></path>
              </svg>
</a>


          </li>
          <li class="astro-IMPBK3X5">
            <button id="theme-btn" class="focus-outline astro-IMPBK3X5" title="Toggles light & dark" aria-label="auto" aria-live="polite">
                  <svg xmlns="http://www.w3.org/2000/svg" id="moon-svg" class="astro-IMPBK3X5">
                    <path d="M20.742 13.045a8.088 8.088 0 0 1-2.077.271c-2.135 0-4.14-.83-5.646-2.336a8.025 8.025 0 0 1-2.064-7.723A1 1 0 0 0 9.73 2.034a10.014 10.014 0 0 0-4.489 2.582c-3.898 3.898-3.898 10.243 0 14.143a9.937 9.937 0 0 0 7.072 2.93 9.93 9.93 0 0 0 7.07-2.929 10.007 10.007 0 0 0 2.583-4.491 1.001 1.001 0 0 0-1.224-1.224zm-2.772 4.301a7.947 7.947 0 0 1-5.656 2.343 7.953 7.953 0 0 1-5.658-2.344c-3.118-3.119-3.118-8.195 0-11.314a7.923 7.923 0 0 1 2.06-1.483 10.027 10.027 0 0 0 2.89 7.848 9.972 9.972 0 0 0 7.848 2.891 8.036 8.036 0 0 1-1.484 2.059z" class="astro-IMPBK3X5"></path>
                  </svg>
                  <svg xmlns="http://www.w3.org/2000/svg" id="sun-svg" class="astro-IMPBK3X5">
                    <path d="M6.993 12c0 2.761 2.246 5.007 5.007 5.007s5.007-2.246 5.007-5.007S14.761 6.993 12 6.993 6.993 9.239 6.993 12zM12 8.993c1.658 0 3.007 1.349 3.007 3.007S13.658 15.007 12 15.007 8.993 13.658 8.993 12 10.342 8.993 12 8.993zM10.998 19h2v3h-2zm0-17h2v3h-2zm-9 9h3v2h-3zm17 0h3v2h-3zM4.219 18.363l2.12-2.122 1.415 1.414-2.12 2.122zM16.24 6.344l2.122-2.122 1.414 1.414-2.122 2.122zM6.342 7.759 4.22 5.637l1.415-1.414 2.12 2.122zm13.434 10.605-1.414 1.414-2.122-2.122 1.414-1.414z" class="astro-IMPBK3X5"></path>
                  </svg>
                </button>
          </li>
        </ul>
      </nav>
    </div>
  </div>
  <div class="max-w-3xl mx-auto px-4">
  <hr class="border-skin-line" aria-hidden="true">
</div>
</header>



<div class="max-w-3xl mx-auto w-full px-2 flex justify-start astro-TUOHNYCG">
    <button class="mt-8 mb-2 hover:opacity-75 flex focus-outline astro-TUOHNYCG" onclick="history.back()">
      <svg xmlns="http://www.w3.org/2000/svg" class="astro-TUOHNYCG"><path d="M13.293 6.293 7.586 12l5.707 5.707 1.414-1.414L10.414 12l4.293-4.293z" class="astro-TUOHNYCG"></path>
      </svg><span class="astro-TUOHNYCG">Go back</span>
    </button>
  </div><main id="main-content" class="astro-TUOHNYCG">
    <h1 class="post-title astro-TUOHNYCG">Docker(Docker-compose) + Wordpress/Bedrock.</h1>
    <div class="opacity-80 flex items-center space-x-2 my-2 astro-TUOHNYCG"><svg xmlns="http://www.w3.org/2000/svg" class="scale-100 w-6 h-6 inline-block fill-skin-base" aria-hidden="true"><path d="M7 11h2v2H7zm0 4h2v2H7zm4-4h2v2h-2zm0 4h2v2h-2zm4-4h2v2h-2zm0 4h2v2h-2z"></path><path d="M5 22h14c1.103 0 2-.897 2-2V6c0-1.103-.897-2-2-2h-2V2h-2v2H9V2H7v2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2zM19 8l.001 12H5V8h14z"></path></svg><span class="sr-only">Posted on:</span><span class="italic text-base">8 september 2018<span aria-hidden="true"> | </span><span class="sr-only"> at </span>00:12</span></div>
    <article id="article" role="article" class="mx-auto max-w-3xl mt-8 prose astro-TUOHNYCG">
      <p>This is a small article on how you can work with Docker and Wordpress(bedrock) to be able to host an wordpress site inside a docker machine.
#Information</p>
<h2 id="wordpress">Wordpress:</h2>
<p>Wordpress are one of the most used CMS system for websites. Wordpress is baded on PHP and MySQL. Wordpress was released fist time May 27 2003 by WordpressFoundation. As Wordpress are a big CMS system does a lot of people create plugins, themes and so on for Wordpress which later on, Other people can use.</p>
<h2 id="bedrock">Bedrock:</h2>
<p>Bedrock are an “WordPress boilerplate with modern development tools, easier configuration, and an improved folder structure” - Roots. Bedrock makes it possible to easy handle a Wordpress installation and plugins through an PHP dependency manager named <a href="https://getcomposer.org/">composer</a>. Bedrock is using Dotenv to be able to easy work with different environments for different purpose. This makes you able to work with production, staging and dev environments etc.
Bedrock is also providing security by isolate web root to limit access to non-web files and also more secure passwords by working with <a href="https://github.com/roots/wp-password-bcrypt">wp-password-bcrypt</a>.</p>
<h2 id="docker">Docker:</h2>
<p>Docker is an set coupled SaaS(Software-as-a-service) and PaaS(Platform-as-a-service) products that are using Operating-System-Level Virtualization. This systems or projects that are hosted as a package inside docker are called containers. Multiple Containers are able to to run on the same machine and share the OS kernel that the operativ system provide. Container compared to and Virtual Machine use less space and can handle more applications and require fewer VMs and Operating systems.
<img src="images/wordpress/docker-docker-compose-wordpress-bedrock/docker.png" alt="Docker"/></p>
<h2 id="composer">Composer:</h2>
<p>Composer is a Dependency Manager(Not a Package Manager). Composer makes it possible, in this scenario, to be able to install plugins through command line. More information about composer can you read here
Bedrock and Wordpress
What you need in order to start</p>
<ul>
<li>Docker</li>
<li>Composer</li>
<li>A MySQL database setup.</li>
</ul>
<h2 id="setup">Setup</h2>
<p>From a folder you like run the</p>
<p><code>composer create-project roots/bedrock</code></p>
<p>This command will create a Bedrock folder with necessary files and folders.
Files and folder inside the Bedrock folder:</p>
<p><img src="images/wordpress/docker-docker-compose-wordpress-bedrock/folder.png" alt="Folder"/></p>
<p>Information about the folders
Config:
<img src="images/wordpress/docker-docker-compose-wordpress-bedrock/config.png" alt="Enviorment"/></p>
<p>Web:</p>
<p><img src="images/wordpress/docker-docker-compose-wordpress-bedrock/docker.png" alt="Structure"/></p>
<p>Working with environments
As Bedrock supports use of env, is it really simple to use different .env files. If you add an environments folder with different .env are you able to load different .env files depending of which docker-compose file you will choose(Use of different docker-compose file will come later in this post).
Exempel of .env file:</p>
<pre class="astro-code" style="background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word"><code><span class="line"><span style="color:#abb2bf">DB_NAME=database_name</span></span>
<span class="line"><span style="color:#abb2bf">DB_USER=database_user</span></span>
<span class="line"><span style="color:#abb2bf">DB_PASSWORD=database_password</span></span>
<span class="line"><span style="color:#abb2bf"></span></span>
<span class="line"><span style="color:#abb2bf"># Optionally, you can use a data source name (DSN)</span></span>
<span class="line"><span style="color:#abb2bf"># When using a DSN, you can remove the DB_NAME, DB_USER, DB_PASSWORD, and DB_HOST variables</span></span>
<span class="line"><span style="color:#abb2bf"># DATABASE_URL=mysql://database_user:database_password@database_host:database_port/database_name</span></span>
<span class="line"><span style="color:#abb2bf"></span></span>
<span class="line"><span style="color:#abb2bf"># Optional variables</span></span>
<span class="line"><span style="color:#abb2bf"># DB_HOST=localhost</span></span>
<span class="line"><span style="color:#abb2bf"># DB_PREFIX=wp_</span></span>
<span class="line"><span style="color:#abb2bf"></span></span>
<span class="line"><span style="color:#abb2bf">WP_ENV=development</span></span>
<span class="line"><span style="color:#abb2bf">WP_HOME=http://example.com</span></span>
<span class="line"><span style="color:#abb2bf">WP_SITEURL=${WP_HOME}/wp</span></span>
<span class="line"><span style="color:#abb2bf"></span></span>
<span class="line"><span style="color:#abb2bf"># Generate your keys here: https://roots.io/salts.html</span></span>
<span class="line"><span style="color:#abb2bf">AUTH_KEY=&#39;s]Ae(9f!]KK.hYej(:m6qQ.S[xYQAoA&amp;1IJ1S2P3$pU(5.OQxR*7t3Zcm+0;bjEX&#39;</span></span>
<span class="line"><span style="color:#abb2bf">SECURE_AUTH_KEY=&#39;N#1;&amp;qR+eESza?AHsE`:}vHpitkG5|xgh6v&amp;q.Z4YHit%mv&#39;</span></span>
<span class="line"><span style="color:#abb2bf">NONCE_KEY=&#39;8ncSeT1eS5X,q&gt;a4y`*=XvczTi&gt;&amp;P92fK4naUmvxEM66;(X1_3kE7qYkRnxoFxFN&#39;</span></span>
<span class="line"><span style="color:#abb2bf">AUTH_SALT=&#39;(JGfH8,6P}+&gt;]I+3gyo-Q(KpFN_T&amp;fe[]K+5X!jq}]Cw3l&#39;</span></span>
<span class="line"><span style="color:#abb2bf">SECURE_AUTH_SALT=&#39;j&gt;O{0B(94Cy_d!=oLJC$1t&amp;T&amp;7z5A&gt;5&amp;kV:]EdN,!ZNOH&gt;QdVLq`!QTDj&amp;VUj1gG&#39;</span></span>
<span class="line"><span style="color:#abb2bf">LOGGED_IN_SALT=&#39;X2WjCA1.?&gt;S+8KT9M19fxD4c#TQ0W&gt;Mdn9`P2X1p)NZ%lS+RuXlI$N5323,?}&gt;L}&#39;</span></span>
<span class="line"><span style="color:#abb2bf">NONCE_SALT=&#39;fGcv0C0wk3}+L</span></span></code></pre>
<p>This file are you able to clone into for exempel .env.staging or .env.production to be able to work with different environments. You can add any env variable and load this variable into application.php and the project by defining an variable in the application.php and use the env variable as value. Exempel:
Inside .env.production:</p>
<pre class="astro-code" style="background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word"><code><span class="line"><span style="color:#abb2bf">TWITTER_URL = https://twitter.com/emil_priver</span></span></code></pre>
<p>And load the env variable inside application.php with:</p>
<pre class="astro-code" style="background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word"><code><span class="line"><span style="color:#E5C07B">Config</span><span style="color:#ABB2BF">::</span><span style="color:#61AFEF">define</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">&#39;TWITTER_URL&#39;</span><span style="color:#ABB2BF">, </span><span style="color:#61AFEF">env</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">&#39;TWITTER_URL&#39;</span><span style="color:#ABB2BF">));</span></span></code></pre>
<p>Then you are able to call the new defined variable with TWITTER_URL</p>
<h2 id="creating-the-theme">Creating the theme.</h2>
<p>Developing your theme are the same as with an normal installation. Create your folder inside themes folder and code your theme.</p>
<p>I recommend to work with <a href="https://roots.io/sage-9/">Roots Sage9</a> which are an theme creator framework that are using <a href="https://laravel.com/docs/5.8/blade">Laravel Blade</a>.</p>
<h2 id="working-with-plugins">Working with plugins</h2>
<p>As you use composer to create the Bedrock/Wordpress installation, is it an great idea to work with composer to install plugins aswell. When you create an bedrock installation does bedrock provide a composer.json file inside the installation. This composer.json file does already have WordPress Packagist which are a great repository to use to install and download plugins to Wordpress.</p>
<h3 id="wordpress-packagist">WordPress Packagist</h3>
<p>Wordpress Packagist are a Composer repository build to be able to install plugins from command line. Wordpress Packagist makes it possible to install plugins easy via an CI/CD and version controll.</p>
<h3 id="so-you-know">So you know.</h3>
<p>Bedrock ads an .gitignore file that are excluding all folder and files inside the plugins, mu-plugins, uploads folders. If you adding custom plugins or files then you need to add that folder to not be excluded inside the .gitignore.</p>
<h2 id="docker-setup">Docker setup</h2>
<h3 id="nginx">Nginx</h3>
<p>Lets go thrue the nginx folder we have in the root directory. This folder have a nginx.conf file and host.conf file. Nginx.conf are a settings file for nginx where you can add custom settings and host.conf are the host file for the site to use. This folder also have an Dockerfile that tells docker which image it should use, but also we’re to mount the .conf files.
Exempel of Dockerfile:</p>
<pre class="astro-code" style="background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word"><code><span class="line"><span style="color:#abb2bf">FROM nginx:latest</span></span>
<span class="line"><span style="color:#abb2bf">COPY /vhost.conf /etc/nginx/conf.d/default.conf</span></span>
<span class="line"><span style="color:#abb2bf">COPY /nginx.conf /etc/nginx/nginx.conf</span></span></code></pre>
<p>Exempel of nginx.conf:</p>
<pre class="astro-code" style="background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word"><code><span class="line"><span style="color:#abb2bf">user nginx;</span></span>
<span class="line"><span style="color:#abb2bf">worker_processes auto;</span></span>
<span class="line"><span style="color:#abb2bf"></span></span>
<span class="line"><span style="color:#abb2bf">pid /var/run/nginx.pid;</span></span>
<span class="line"><span style="color:#abb2bf"></span></span>
<span class="line"><span style="color:#abb2bf">events {</span></span>
<span class="line"><span style="color:#abb2bf">    worker_connections 1024;</span></span>
<span class="line"><span style="color:#abb2bf">}</span></span>
<span class="line"><span style="color:#abb2bf"></span></span>
<span class="line"><span style="color:#abb2bf">http {</span></span>
<span class="line"><span style="color:#abb2bf">    include /etc/nginx/mime.types;</span></span>
<span class="line"><span style="color:#abb2bf">    default_type application/octet-stream;</span></span>
<span class="line"><span style="color:#abb2bf">    include /etc/nginx/conf.d/*.conf;</span></span>
<span class="line"><span style="color:#abb2bf">}</span></span></code></pre>
<p>Exempel of host.conf:</p>
<pre class="astro-code" style="background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word"><code><span class="line"><span style="color:#abb2bf">server {</span></span>
<span class="line"><span style="color:#abb2bf">    listen 80;</span></span>
<span class="line"><span style="color:#abb2bf">    server_name localhost;</span></span>
<span class="line"><span style="color:#abb2bf">    charset utf-8;</span></span>
<span class="line"><span style="color:#abb2bf">    index index.php;</span></span>
<span class="line"><span style="color:#abb2bf">    root /var/www/html/web;</span></span>
<span class="line"><span style="color:#abb2bf"></span></span>
<span class="line"><span style="color:#abb2bf">    location / {</span></span>
<span class="line"><span style="color:#abb2bf">        try_files $uri $uri/ /index.php?$args;</span></span>
<span class="line"><span style="color:#abb2bf">    }</span></span>
<span class="line"><span style="color:#abb2bf"></span></span>
<span class="line"><span style="color:#abb2bf">    location ~ \.php$ {</span></span>
<span class="line"><span style="color:#abb2bf">        try_files $uri =404;</span></span>
<span class="line"><span style="color:#abb2bf">        fastcgi_split_path_info ^(.+\.php)(/.+)$;</span></span>
<span class="line"><span style="color:#abb2bf">        fastcgi_pass php-fpm:9000;</span></span>
<span class="line"><span style="color:#abb2bf">        fastcgi_index index.php;</span></span>
<span class="line"><span style="color:#abb2bf">        fastcgi_read_timeout 300s;</span></span>
<span class="line"><span style="color:#abb2bf">        include fastcgi_params;</span></span>
<span class="line"><span style="color:#abb2bf">        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span></span>
<span class="line"><span style="color:#abb2bf">        fastcgi_param PATH_INFO $fastcgi_path_info;</span></span>
<span class="line"><span style="color:#abb2bf">    }</span></span>
<span class="line"><span style="color:#abb2bf">}</span></span></code></pre>
<h3 id="php">PHP</h3>
<p>In order to execute our Wordpress PHP code do we need an PHP image. As this is an basic guide will we keep it simple. Inside our docker-compose file can we easy add</p>
<pre class="astro-code" style="background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word"><code><span class="line"><span style="color:#abb2bf">image: php:7.3.6-fpm-alpine3.9</span></span></code></pre>
<p>which will add the php library we need, but this is not the only thing we need to do. If we start our app with docker-compose and going to localhost:8080 will we probably see an 404 page. why? As we haven’t mounted the code into PHP so PHP can’t access the code. How to fix? By adding volume which mounts the code into docker, like this:</p>
<pre class="astro-code" style="background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word"><code><span class="line"><span style="color:#abb2bf">volumes:</span></span>
<span class="line"><span style="color:#abb2bf">- ./website/bedrock:/var/www/html</span></span></code></pre>
<p>The PHP part of the docker-compose file should look like this now:</p>
<pre class="astro-code" style="background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word"><code><span class="line"><span style="color:#abb2bf">php:</span></span>
<span class="line"><span style="color:#abb2bf">image: php:7.3.6-fpm-alpine3.9</span></span>
<span class="line"><span style="color:#abb2bf">volumes:</span></span>
<span class="line"><span style="color:#abb2bf">- ./website/bedrock:/var/www/html</span></span></code></pre>
<h3 id="docker-1">Docker</h3>
<p>Docker are an awesome tool to use and makes alot possible while developing with Bedrock and Wordpress. With an CI/CD make this setup it possible to easy deploy multiple container to different servers and use the same database and so on. So how does our final docker-compose file look? Like this:</p>
<pre class="astro-code" style="background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word"><code><span class="line"><span style="color:#abb2bf">version: &#39;3&#39;</span></span>
<span class="line"><span style="color:#abb2bf">services:</span></span>
<span class="line"><span style="color:#abb2bf">  nginx:</span></span>
<span class="line"><span style="color:#abb2bf">    build: ./nginx</span></span>
<span class="line"><span style="color:#abb2bf">    volumes:</span></span>
<span class="line"><span style="color:#abb2bf">      - ./website/bedrock:/var/www/html</span></span>
<span class="line"><span style="color:#abb2bf">    ports:</span></span>
<span class="line"><span style="color:#abb2bf">      - &#39;8080:80&#39;</span></span>
<span class="line"><span style="color:#abb2bf">    depends_on:</span></span>
<span class="line"><span style="color:#abb2bf">      - php</span></span>
<span class="line"><span style="color:#abb2bf">  php:</span></span>
<span class="line"><span style="color:#abb2bf">    image: php:7.3.6-fpm-alpine3.9</span></span>
<span class="line"><span style="color:#abb2bf">    volumes:</span></span>
<span class="line"><span style="color:#abb2bf">      - ./website/bedrock:/var/www/html</span></span>
<span class="line"><span style="color:#abb2bf">      </span></span></code></pre>
<p>What if we want to use an different .env file then the one we have inside our bedrock folder? No problem, this is really simple:</p>
<pre class="astro-code" style="background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word"><code><span class="line"><span style="color:#abb2bf">version: &#39;3&#39;</span></span>
<span class="line"><span style="color:#abb2bf">services:</span></span>
<span class="line"><span style="color:#abb2bf">  nginx:</span></span>
<span class="line"><span style="color:#abb2bf">    build: ./nginx</span></span>
<span class="line"><span style="color:#abb2bf">    volumes:</span></span>
<span class="line"><span style="color:#abb2bf">      - ./website/bedrock:/var/www/html</span></span>
<span class="line"><span style="color:#abb2bf">    ports:</span></span>
<span class="line"><span style="color:#abb2bf">      - &#39;8080:80&#39;</span></span>
<span class="line"><span style="color:#abb2bf">    depends_on:</span></span>
<span class="line"><span style="color:#abb2bf">      - php</span></span>
<span class="line"><span style="color:#abb2bf">  php:</span></span>
<span class="line"><span style="color:#abb2bf">    image: php:7.3.6-fpm-alpine3.9</span></span>
<span class="line"><span style="color:#abb2bf">    env_file:</span></span>
<span class="line"><span style="color:#abb2bf">      - ./path/to/custom/env-file/.env</span></span>
<span class="line"><span style="color:#abb2bf"></span></span>
<span class="line"><span style="color:#abb2bf">    volumes:</span></span>
<span class="line"><span style="color:#abb2bf">      - ./website/bedrock:/var/www/html</span></span></code></pre>
<p>By adding env_file into PHP settings of the docker-compose file are we able mount an env file into Bedrock.
If you want to use different env for different enviornments(exempel production or development). Then copy the docker-compose file we have into something else, ex: docker-compose.production.yml and start docker-compose using this file, like this:</p>
<pre class="astro-code" style="background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word"><code><span class="line"><span style="color:#abb2bf">docker-compose -f docker-compose.production.yml up --build</span></span></code></pre>
<p>Or if you want to start the normal docker-compose file use:</p>
<pre class="astro-code" style="background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word"><code><span class="line"><span style="color:#abb2bf">docker-compose up --build</span></span></code></pre>
<h2 id="end">End</h2>
<p>This should be all the stuffs needed to get started with Docker + Bedrock/Wordpress. As this is an basic guide did I want to have everything at a basic level. Docker and Bedrock are great and with adding some information to all this are you able to use different enviornments, use different php.ini and so on.</p>
<p>An exempel of an site using this setup are Leagueshop. This website have Gitlabs CI/CD connected so we never need to login to the server to build the website. The main reason we are using this setup are to be able to scale when more users comes. If many users visits the website, are we able to connect the server we have to an Load Balancer and then startup more servers to be able to run many Wordpress projects on many servers to work against downtime but also have redundancy when alot of users are visiting the site.</p>
<p>DM me for any questions.</p>
<p>GitHub project that you can use as template: <a href="https://github.com/emilpriver/wordpress-docker-bedrock-starter">https://github.com/emilpriver/wordpress-docker-bedrock-starter</a></p>
<p>Twitter for DMs: <a href="https://twitter.com/emil_priver">https://twitter.com/emil_priver</a></p>
    </article>

    <ul class="tags-container astro-TUOHNYCG">
      <li class="inline-block my-1 underline-offset-4 astro-M5B7HHFI">
  <a href="/tags/docker" class="pr-1 text-sm group astro-M5B7HHFI">
    <svg xmlns="http://www.w3.org/2000/svg" class=" scale-75 astro-M5B7HHFI"><path d="M16.018 3.815 15.232 8h-4.966l.716-3.815-1.964-.37L8.232 8H4v2h3.857l-.751 4H3v2h3.731l-.714 3.805 1.965.369L8.766 16h4.966l-.714 3.805 1.965.369.783-4.174H20v-2h-3.859l.751-4H21V8h-3.733l.716-3.815-1.965-.37zM14.106 14H9.141l.751-4h4.966l-.752 4z" class="astro-M5B7HHFI"></path>
    </svg>
    &nbsp;<span class="astro-M5B7HHFI">docker</span>
  </a>
</li>

<li class="inline-block my-1 underline-offset-4 astro-M5B7HHFI">
  <a href="/tags/wordpress" class="pr-1 text-sm group astro-M5B7HHFI">
    <svg xmlns="http://www.w3.org/2000/svg" class=" scale-75 astro-M5B7HHFI"><path d="M16.018 3.815 15.232 8h-4.966l.716-3.815-1.964-.37L8.232 8H4v2h3.857l-.751 4H3v2h3.731l-.714 3.805 1.965.369L8.766 16h4.966l-.714 3.805 1.965.369.783-4.174H20v-2h-3.859l.751-4H21V8h-3.733l.716-3.815-1.965-.37zM14.106 14H9.141l.751-4h4.966l-.752 4z" class="astro-M5B7HHFI"></path>
    </svg>
    &nbsp;<span class="astro-M5B7HHFI">wordpress</span>
  </a>
</li>


    </ul>
  </main><footer class="mt-auto astro-FAGJKM3J">
  <div class="max-w-3xl mx-auto px-0">
  <hr class="border-skin-line" aria-hidden="true">
</div>
  <div class="footer-wrapper astro-FAGJKM3J">
    <div class="social-icons flex astro-DCFUEFV5">
  <a type="button" href="https://github.com/emilpriver" tabindex="0" class="group link-button astro-DCFUEFV5 astro-AENLN72D" title=" Emil Privér on Github">
  <svg
    xmlns="http://www.w3.org/2000/svg"
    class="icon-tabler"
    stroke-linecap="round"
    stroke-linejoin="round"
  >
    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
    <path
      d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"
    ></path>
  </svg>
</a>

<a type="button" href="https://instagram.com/emil_priver" tabindex="0" class="group link-button astro-DCFUEFV5 astro-AENLN72D" title="Emil Privér on Instagram">
  <svg
    xmlns="http://www.w3.org/2000/svg"
    class="icon-tabler"
    stroke-linecap="round"
    stroke-linejoin="round"
  >
    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
    <rect x="4" y="4" width="16" height="16" rx="4"></rect>
    <circle cx="12" cy="12" r="3"></circle>
    <line x1="16.5" y1="7.5" x2="16.5" y2="7.501"></line>
  </svg>
</a>

<a type="button" href="https://www.linkedin.com/in/emilpriver/" tabindex="0" class="group link-button astro-DCFUEFV5 astro-AENLN72D" title="Emil Privér on LinkedIn">
  <svg
    xmlns="http://www.w3.org/2000/svg"
    class="icon-tabler"
    stroke-linecap="round"
    stroke-linejoin="round"
  >
    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
    <rect x="4" y="4" width="16" height="16" rx="2"></rect>
    <line x1="8" y1="11" x2="8" y2="16"></line>
    <line x1="8" y1="8" x2="8" y2="8.01"></line>
    <line x1="12" y1="16" x2="12" y2="11"></line>
    <path d="M16 16v-3a2 2 0 0 0 -4 0"></path>
  </svg>
</a>

<a type="button" href="https://twitter.com/emil_priver" tabindex="0" class="group link-button astro-DCFUEFV5 astro-AENLN72D" title="Emil Privér on Twitter">
  <svg
      xmlns="http://www.w3.org/2000/svg"
      class="icon-tabler"
      stroke-linecap="round"
      stroke-linejoin="round"
    >
      <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
      <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z"></path>
    </svg>
</a>

<a type="button" href="https://twitch.tv/privann" tabindex="0" class="group link-button astro-DCFUEFV5 astro-AENLN72D" title="Emil Privér on Twitch">
  <svg
      xmlns="http://www.w3.org/2000/svg"
      class="icon-tabler"
      stroke-linecap="round"
      stroke-linejoin="round"
    >
      <path d="M21 2H3v16h5v4l4-4h5l4-4V2zm-10 9V7m5 4V7"></path>
    </svg>
</a>


</div>


    <div class="copyright-wrapper astro-FAGJKM3J">
      <span class="astro-FAGJKM3J">Copyright &#169; 2022</span>
      <span class="separator astro-FAGJKM3J">&nbsp;|&nbsp;</span>
      <span class="astro-FAGJKM3J">All rights reserved.</span>
    </div>
  </div>
</footer>


  </body></html>

